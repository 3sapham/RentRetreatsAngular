{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"./reservations.service\";\nimport * as i4 from \"../houses/houses.service\";\nimport * as i5 from \"@angular/common\";\nfunction ReservationformComponent_option_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const house_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", house_r4.HouseId);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(house_r4.Title);\n  }\n}\nfunction ReservationformComponent_img_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 20);\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"src\", ctx_r2.chosenHouse.HouseImageUrl, i0.ɵɵsanitizeUrl)(\"alt\", ctx_r2.chosenHouse.Description);\n  }\n}\nfunction ReservationformComponent_div_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21)(1, \"span\");\n    i0.ɵɵtext(2, \"Total Price: \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"span\");\n    i0.ɵɵtext(4, \"(not implemented yet)\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport class ReservationformComponent {\n  constructor(_formbuilder, _router, _route, _reservationService, _houseService) {\n    this._formbuilder = _formbuilder;\n    this._router = _router;\n    this._route = _route;\n    this._reservationService = _reservationService;\n    this._houseService = _houseService;\n    this.isEditMode = false;\n    this.reservationId = -1;\n    this.houses = [];\n    this.houseSelectList = this.houses;\n    this.reservationForm = _formbuilder.group({\n      houseId: ['', Validators.required],\n      checkInDate: [new Date(), Validators.required],\n      checkOutDate: [new Date(), Validators.required]\n    });\n  }\n  getHouses() {\n    this._houseService.getHouses().subscribe(data => {\n      console.log('All', JSON.stringify(data));\n      this.houseSelectList = data;\n    });\n  }\n  onSubmit() {\n    console.log(\"ReservationCreate form submitted:\");\n    console.log(this.reservationForm);\n    const newReservation = this.reservationForm.value;\n    if (this.isEditMode) {\n      this._reservationService.updateReservation(this.reservationId, newReservation).subscribe(response => {\n        if (response.success) {\n          console.log(response.message);\n          this._router.navigate(['/reservations']);\n        } else {\n          console.log('Reservation update failed');\n        }\n      });\n    } else {\n      this._reservationService.createReservation(newReservation).subscribe(response => {\n        if (response.success) {\n          console.log(response.message);\n          this._router.navigate(['/reservations']);\n        } else {\n          console.log('Reservation creation failed');\n        }\n      });\n    }\n  }\n  backToReservations() {\n    this._router.navigate(['/reservations']);\n  }\n  ngOnInit() {\n    this.getHouses();\n    this._route.params.subscribe(params => {\n      if (params['mode'] === 'create') {\n        this.isEditMode = false; // Create mode\n      } else if (params['mode'] === 'edit') {\n        this.isEditMode = true; // Edit mode\n        this.reservationId = +params['id']; // Convert to number\n        this.loadReservationForEdit(this.reservationId);\n      }\n    });\n  }\n  loadReservationForEdit(reservationId) {\n    this._reservationService.getReservationById(reservationId).subscribe(reservation => {\n      console.log('retrieved reservation: ', reservation);\n      this.reservationForm.patchValue({\n        houseId: reservation.HouseId,\n        checkInDate: this.formatDate(new Date(reservation.CheckInDate)),\n        checkOutDate: this.formatDate(new Date(reservation.CheckOutDate))\n      });\n    }, error => {\n      console.error('Error loading reservation for edit:', error);\n    });\n  }\n  formatDate(date) {\n    const year = date.getFullYear();\n    const month = ('0' + (date.getMonth() + 1)).slice(-2);\n    const day = ('0' + date.getDate()).slice(-2);\n    return `${year}-${month}-${day}`;\n  }\n  changeHouse(houseIdString) {\n    const houseId = +houseIdString;\n    if (!isNaN(houseId)) {\n      this._houseService.getHouseById(houseId).subscribe(house => {\n        this.chosenHouse = house;\n      }, error => {\n        console.error('Error changing houses:', error);\n      });\n    } else {\n      console.error('houseSelect is not a number');\n    }\n  }\n}\nReservationformComponent.ɵfac = function ReservationformComponent_Factory(t) {\n  return new (t || ReservationformComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.ReservationService), i0.ɵɵdirectiveInject(i4.HouseService));\n};\nReservationformComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ReservationformComponent,\n  selectors: [[\"app-reservations-reservationform\"]],\n  decls: 27,\n  vars: 7,\n  consts: [[1, \"p-5\", \"shadow-sm\", 2, \"border-radius\", \"15px\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"form-group\", \"row\"], [1, \"form-floating\", \"col-md-4\", \"mb-3\", \"gx-1\"], [\"formControlName\", \"houseId\", 1, \"form-select\", 3, \"change\"], [\"houseSelect\", \"\"], [\"value\", \"0\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"for\", \"houseId\", 1, \"form-label\"], [1, \"form-floating\", \"col-md-3\", \"mb-3\", \"gx-1\"], [\"type\", \"date\", \"id\", \"checkInDate\", \"formControlName\", \"checkInDate\", 1, \"form-control\"], [\"for\", \"checkInDate\", 1, \"form-label\"], [\"type\", \"date\", \"id\", \"checkOutDate\", \"formControlName\", \"checkOutDate\", 1, \"form-control\"], [\"for\", \"checkOutDate\", 1, \"form-label\"], [1, \"col-md-2\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", \"rounded-pill\", 2, \"height\", \"50px\", 3, \"disabled\"], [1, \"reservation-info\", \"row\"], [\"class\", \"col-md-4 mb-3 gx-1\", 3, \"src\", \"alt\", 4, \"ngIf\"], [\"class\", \"col-md-4 gx-1\", 4, \"ngIf\"], [3, \"value\"], [1, \"col-md-4\", \"mb-3\", \"gx-1\", 3, \"src\", \"alt\"], [1, \"col-md-4\", \"gx-1\"]],\n  template: function ReservationformComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      const _r5 = i0.ɵɵgetCurrentView();\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\");\n      i0.ɵɵtext(2);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(3, \"form\", 1);\n      i0.ɵɵlistener(\"ngSubmit\", function ReservationformComponent_Template_form_ngSubmit_3_listener() {\n        return ctx.onSubmit();\n      });\n      i0.ɵɵelementStart(4, \"div\", 2)(5, \"div\", 3)(6, \"select\", 4, 5);\n      i0.ɵɵlistener(\"change\", function ReservationformComponent_Template_select_change_6_listener() {\n        i0.ɵɵrestoreView(_r5);\n        const _r0 = i0.ɵɵreference(7);\n        return i0.ɵɵresetView(ctx.changeHouse(_r0.value));\n      });\n      i0.ɵɵelementStart(8, \"option\", 6);\n      i0.ɵɵtext(9, \"Select a house...\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(10, ReservationformComponent_option_10_Template, 2, 2, \"option\", 7);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(11, \"label\", 8);\n      i0.ɵɵtext(12, \"HouseId:\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(13, \"div\", 9);\n      i0.ɵɵelement(14, \"input\", 10);\n      i0.ɵɵelementStart(15, \"label\", 11);\n      i0.ɵɵtext(16, \"Check In Date:\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(17, \"div\", 9);\n      i0.ɵɵelement(18, \"input\", 12);\n      i0.ɵɵelementStart(19, \"label\", 13);\n      i0.ɵɵtext(20, \"Check Out Date:\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(21, \"div\", 14)(22, \"button\", 15);\n      i0.ɵɵtext(23);\n      i0.ɵɵelementEnd()()()();\n      i0.ɵɵelementStart(24, \"div\", 16);\n      i0.ɵɵtemplate(25, ReservationformComponent_img_25_Template, 1, 2, \"img\", 17);\n      i0.ɵɵtemplate(26, ReservationformComponent_div_26_Template, 5, 0, \"div\", 18);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate1(\"\", ctx.isEditMode ? \"Update\" : \"Create\", \" Reservation\");\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"formGroup\", ctx.reservationForm);\n      i0.ɵɵadvance(7);\n      i0.ɵɵproperty(\"ngForOf\", ctx.houseSelectList);\n      i0.ɵɵadvance(12);\n      i0.ɵɵproperty(\"disabled\", ctx.reservationForm.invalid);\n      i0.ɵɵadvance(1);\n      i0.ɵɵtextInterpolate1(\" \", ctx.isEditMode ? \"Update\" : \"Create\", \" Reservation \");\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"ngIf\", ctx.chosenHouse);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.chosenHouse);\n    }\n  },\n  dependencies: [i5.NgForOf, i5.NgIf, i1.ɵNgNoValidate, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.DefaultValueAccessor, i1.SelectControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName],\n  styles: [\"body[_ngcontent-%COMP%] {\\n}\\n.reservation-info[_ngcontent-%COMP%]   div[_ngcontent-%COMP%] {\\n  margin-top: 2rem;\\n  margin-left: 2rem;\\n}\\n\\n.reservation-info[_ngcontent-%COMP%]   img[_ngcontent-%COMP%] {\\n    border-radius: 2rem;\\n}\\n\\n.reservation-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%] {\\n    font-size: 1rem;\\n}\\n\\n.reservation-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child {\\n    font-weight: bold;\\n    font-size: 1.5rem;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvcmVzZXJ2YXRpb25zL3Jlc2VydmF0aW9uZm9ybS5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtFQUNFLGdCQUFnQjtFQUNoQixpQkFBaUI7QUFDbkI7O0FBRUE7SUFDSSxtQkFBbUI7QUFDdkI7O0FBRUE7SUFDSSxlQUFlO0FBQ25COztBQUVBO0lBQ0ksaUJBQWlCO0lBQ2pCLGlCQUFpQjtBQUNyQiIsInNvdXJjZXNDb250ZW50IjpbImJvZHkge1xufVxuLnJlc2VydmF0aW9uLWluZm8gZGl2IHtcbiAgbWFyZ2luLXRvcDogMnJlbTtcbiAgbWFyZ2luLWxlZnQ6IDJyZW07XG59XG5cbi5yZXNlcnZhdGlvbi1pbmZvIGltZyB7XG4gICAgYm9yZGVyLXJhZGl1czogMnJlbTtcbn1cblxuLnJlc2VydmF0aW9uLWluZm8gc3BhbiB7XG4gICAgZm9udC1zaXplOiAxcmVtO1xufVxuXG4ucmVzZXJ2YXRpb24taW5mbyBzcGFuOmZpcnN0LWNoaWxkIHtcbiAgICBmb250LXdlaWdodDogYm9sZDtcbiAgICBmb250LXNpemU6IDEuNXJlbTtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0= */\"]\n});","map":{"version":3,"mappings":"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","names":["Validators","i0","ReservationformComponent","constructor","_formbuilder","_router","_route","_reservationService","_houseService","houses","reservationForm","group","houseId","required","checkInDate","Date","checkOutDate","getHouses","subscribe","data","console","log","JSON","stringify","houseSelectList","onSubmit","newReservation","value","isEditMode","updateReservation","reservationId","response","success","message","navigate","createReservation","backToReservations","ngOnInit","params","loadReservationForEdit","getReservationById","reservation","patchValue","HouseId","formatDate","CheckInDate","CheckOutDate","error","date","year","getFullYear","month","getMonth","slice","day","getDate","changeHouse","houseIdString","isNaN","getHouseById","house","chosenHouse","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/Users/teresapham/Projects/Group-Project-2/Group-Project-2/ClientApp/src/app/reservations/reservationform.component.ts","/Users/teresapham/Projects/Group-Project-2/Group-Project-2/ClientApp/src/app/reservations/reservationform.component.html"],"sourcesContent":["import { Component } from \"@angular/core\";\nimport { FormGroup, FormControl, Validators, FormBuilder, ReactiveFormsModule } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { ReservationService } from './reservations.service';\nimport { HouseService } from '../houses/houses.service';\nimport { IHouse } from '../houses/house';\n\n@Component({\n  selector: \"app-reservations-reservationform\",\n  templateUrl: \"./reservationform.component.html\",\n  styleUrls: ['./reservationform.component.css']\n})\nexport class ReservationformComponent {\n  reservationForm: FormGroup;\n  isEditMode: boolean = false;\n  reservationId: number = -1;\n  houses: IHouse[] = [];\n\n  constructor(\n    private _formbuilder: FormBuilder,\n    private _router: Router,\n    private _route: ActivatedRoute,\n    private _reservationService: ReservationService,\n    private _houseService: HouseService\n  ) {\n    this.reservationForm = _formbuilder.group({\n      houseId: ['', Validators.required],\n      checkInDate: [new Date(), Validators.required],\n      checkOutDate: [new Date(), Validators.required],\n    });\n  }\n\n  getHouses(): void {\n    this._houseService.getHouses()\n      .subscribe(data => {\n        console.log('All', JSON.stringify(data));\n        this.houseSelectList = data;\n      }\n      );\n  }\n\n  houseSelectList: IHouse[] = this.houses;\n\n  onSubmit() {\n    console.log(\"ReservationCreate form submitted:\");\n    console.log(this.reservationForm);\n    const newReservation = this.reservationForm.value;\n    if (this.isEditMode) {\n      this._reservationService.updateReservation(this.reservationId, newReservation)\n        .subscribe(response => {\n          if (response.success) {\n            console.log(response.message);\n            this._router.navigate(['/reservations']);\n          } else {\n            console.log('Reservation update failed');\n          }\n        });\n    } else {\n      this._reservationService.createReservation(newReservation)\n        .subscribe(response => {\n          if (response.success) {\n            console.log(response.message);\n            this._router.navigate(['/reservations']);\n          }\n          else {\n            console.log('Reservation creation failed');\n          }\n        });\n    }\n  }\n\n  backToReservations() {\n    this._router.navigate(['/reservations']);\n  }\n\n  ngOnInit(): void {\n    this.getHouses();\n    this._route.params.subscribe(params => {\n      if (params['mode'] === 'create') {\n        this.isEditMode = false; // Create mode\n      } else if (params['mode'] === 'edit') {\n        this.isEditMode = true; // Edit mode\n        this.reservationId = +params['id']; // Convert to number\n        this.loadReservationForEdit(this.reservationId);\n      }\n    });\n  }\n\n  loadReservationForEdit(reservationId: number) {\n    this._reservationService.getReservationById(reservationId)\n      .subscribe(\n        (reservation: any) => {\n          console.log('retrieved reservation: ', reservation);\n          this.reservationForm.patchValue({\n            houseId: reservation.HouseId,\n            checkInDate: this.formatDate(new Date(reservation.CheckInDate)),\n            checkOutDate: this.formatDate(new Date(reservation.CheckOutDate)),\n          });\n        }, (error: any) => {\n          console.error('Error loading reservation for edit:', error);\n        }\n      );\n  }\n\n  private formatDate(date: Date): string {\n    const year = date.getFullYear();\n    const month = ('0' + (date.getMonth() + 1)).slice(-2);\n    const day = ('0' + date.getDate()).slice(-2);\n    return `${year}-${month}-${day}`;\n  }\n\n  chosenHouse!: IHouse;\n  changeHouse(houseIdString: string) {\n    const houseId: number = +houseIdString;\n    if (!isNaN(houseId)) {\n      this._houseService.getHouseById(houseId)\n        .subscribe(\n          (house: any) => {\n            this.chosenHouse = house;\n          }, (error: any) => {\n            console.error('Error changing houses:', error);\n          }\n        );\n    } else {\n      console.error('houseSelect is not a number');\n    }\n  }\n\n}\n","<div class=\"p-5 shadow-sm\" style=\"border-radius: 15px\">\n\n    <h2>{{ isEditMode ? 'Update' : 'Create'}} Reservation</h2>\n\n    <form (ngSubmit)=\"onSubmit()\" [formGroup]=\"reservationForm\">\n        <div class=\"form-group row\">\n            <div class=\"form-floating col-md-4 mb-3 gx-1\">\n                <select #houseSelect formControlName=\"houseId\" class=\"form-select\" (change)=\"changeHouse(houseSelect.value)\">\n                    <option value=0>Select a house...</option>\n                    <option *ngFor=\"let house of houseSelectList\" [value]=\"house.HouseId\">{{ house.Title }}</option>\n                </select>\n                <label for=\"houseId\" class=\"form-label\">HouseId:</label>\n            </div>\n            <div class=\"form-floating col-md-3 mb-3 gx-1\">\n                <input type=\"date\" id=\"checkInDate\" formControlName=\"checkInDate\" class=\"form-control\" />\n                <label for=\"checkInDate\" class=\"form-label\">Check In Date:</label>\n            </div>\n            <div class=\"form-floating col-md-3 mb-3 gx-1\">\n                <input type=\"date\" id=\"checkOutDate\" formControlName=\"checkOutDate\" class=\"form-control\" />\n                <label for=\"checkOutDate\" class=\"form-label\">Check Out Date:</label>\n            </div>\n            <div class=\"col-md-2\">\n                <button class='btn btn-primary rounded-pill' style=\"height: 50px;\" type=\"submit\" [disabled]=\"reservationForm.invalid\">\n                    {{ isEditMode ? 'Update' : 'Create'}} Reservation\n                </button>\n            </div>\n        </div>\n    </form>\n    <div class=\"reservation-info row\">\n        <img *ngIf=\"chosenHouse\" [src]=\"chosenHouse.HouseImageUrl\" [alt]=\"chosenHouse.Description\" class=\"col-md-4 mb-3 gx-1\" />\n        <div *ngIf=\"chosenHouse\" class=\"col-md-4 gx-1\">\n            <span>Total Price: </span>\n            <span>(not implemented yet)</span>\n        </div>\n    </div>\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}